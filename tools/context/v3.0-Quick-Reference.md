# v3.0 Context Model - Quick Reference

**Version**: 3.0  
**Architecture**: 3-Layer Context Model  
**CSAC Priority**: Relationship context before technical context  
**Date**: 2025-11-12

---

## Creating v3.0 Snapshots

```powershell
# Create snapshot with v3.0 3-layer architecture
.\tools\context\Save-LTFContext.ps1 -Tier Micro -Notes "Your description here"

# Options:
#   -Tier: Micro (minimal) | Meso (moderate) | Macro (comprehensive)
#   -Notes: Snapshot description/label
```

**Generated Files**:
- `tier1_user_state.md` - Context Layer 3 (WHO - relationship context)
- `tier2_project_cip.md` - Context Layer 2 (WHAT - project identity)
- `tier3_session_metadata.md` - Context Layer 1 (HOW/WHEN - temporal tracking)
- `influencer-manifest.yaml` - Reference-based manifest (GitHub URLs)
- `transfer-prompt.md` - 5-step CSAC restoration guide
- `Snapshot.md` + `CIP_Preamble.txt` - v2 compatibility files

---

## Resuming v3.0 Snapshots

### Show Transfer Prompt (Copy/Paste into New AI Session)

```powershell
.\tools\context\Resume-LTF.ps1 -Latest
```

### Show Context Layer File Paths (Manual Loading)

```powershell
.\tools\context\Resume-LTF.ps1 -Latest -Load
```

**Loading Priority Order**:
1. **Context Layer 3** (`tier1_user_state.md`) - User State (WHO) - **LOAD FIRST**
2. **Context Layer 2** (`tier2_project_cip.md`) - Project CIP (WHAT) - Load second
3. **Context Layer 1** (`tier3_session_metadata.md`) - Session Metadata (HOW/WHEN) - Load third

### List All Snapshots

```powershell
# List all snapshots (v3.0 snapshots show [v3.0] badge)
.\tools\context\Resume-LTF.ps1 -List

# Filter by project
.\tools\context\Resume-LTF.ps1 -Project ehr-consent -List

# Filter by type
.\tools\context\Resume-LTF.ps1 -Type pivotal -List

# Show latest matching snapshot
.\tools\context\Resume-LTF.ps1 -Project ehr-consent -Latest
```

---

## 3-Layer Context Model Architecture

### Context Layer 3: User State (WHO)
- **File**: `tier1_user_state.md`
- **CSAC Priority**: HIGHEST (relationship context before technical)
- **Contents**:
  - Being Heard Protocol (explicit acknowledgment, precision, validation)
  - Multi-contextual reflection capability (11-dimension processing)
  - Cognitive patterns (brief articulations = complete solutions)
  - AfAP/AdRP protocol states
  - Symbiotic rhythm observations

### Context Layer 2: Project CIP (WHAT)
- **File**: `tier2_project_cip.md`
- **CSAC Priority**: Medium (project identity)
- **Contents**:
  - Active project(s) identification
  - Project goals and current focus
  - Related project connections
  - Project-specific context

### Context Layer 1: Session Metadata (HOW/WHEN)
- **File**: `tier3_session_metadata.md`
- **CSAC Priority**: Standard (temporal tracking)
- **Contents**:
  - BRB/BACK pause log (energy assessment)
  - Pivotal moments buffer (breakthrough insights)
  - Conversation trajectory
  - Session continuity data

---

## Terminology Clarifications

### Application Tiers (Feature Sophistication)
- **Tier 1**: Production-ready core features (must-have)
- **Tier 2**: Enhanced features (valuable, near-term)
- **Tier 3**: Research/experimental features (exploratory)

### Context Layers (v3.0 Architecture)
- **Layer 3**: User State (WHO - tier1_user_state.md)
- **Layer 2**: Project CIP (WHAT - tier2_project_cip.md)
- **Layer 1**: Session Metadata (HOW/WHEN - tier3_session_metadata.md)

**Note**: File names use `tier1/tier2/tier3` for backward compatibility, but semantic meaning is Context Layer 3/2/1.

### AdRP Tiers (Protocol Escalation)
- **Tier 1**: Explicit check-in (ask before adapting)
- **Tier 2**: Transitional hold (observe 2-3 exchanges)
- **Tier 3**: Hybrid compromise (match structure + maintain substance)
- **Tier 4**: Direct mirroring (fallback with escape after 5 exchanges)

---

## v2 vs v3.0 Comparison

| Feature | v2 (Legacy) | v3.0 (Current) |
|---------|-------------|----------------|
| **Architecture** | File-copying to stage directory | 3-Layer Context Model |
| **Size** | 50MB+ (full file copies) | <5MB (reference-based) |
| **CSAC Priority** | Technical context only | Relationship → Project → Session → Technical |
| **Restoration** | Snapshot.md + CIP preamble | 5-step transfer prompt with priority loading |
| **User State** | Not preserved | Full User State Model template |
| **Session Continuity** | Limited | BRB/BACK log + pivotal moments + energy tracking |
| **Cross-Platform** | Manual file review | Transfer prompt with structured steps |

---

## 5-Step CSAC Restoration Process

When resuming in a new AI session, follow this sequence (from `transfer-prompt.md`):

1. **Load User State Model** (`tier1_user_state.md`)
   - Restore relationship context (Being Heard Protocol, cognitive patterns)
   
2. **Validate "Being Heard" Protocol**
   - AI must demonstrate: explicit acknowledgment, precision, validation
   
3. **Load Session Context** (`tier3_session_metadata.md`)
   - Understand what you were working on, pending tasks, energy patterns
   
4. **Load Project Context** (`tier2_project_cip.md`)
   - Identify active project(s), current focus, project state
   
5. **Confirm Context**
   - AI provides summary, user validates before proceeding

---

## Migration Notes

- **v2 snapshots**: Still supported (Resume-LTF detects version automatically)
- **v2 backup**: `Save-LTFContext-v2.ps1` and `Resume-LTF-v2.ps1` preserved
- **Backward compatibility**: v3.0 snapshots include v2 files (Snapshot.md, CIP_Preamble.txt)
- **File naming**: `tier1/tier2/tier3` preserved for compatibility (semantic = Layer 3/2/1)

---

## Future Enhancements

- **Dynamic population**: Populate User State from actual session data (BRB/BACK events, energy observations)
- **Project auto-detection**: Identify active projects from workspace/git instead of placeholder
- **Session tracking**: Real-time BRB/BACK logging during active sessions
- **Cross-session analytics**: Energy pattern analysis across multiple sessions
- **CSAC validation**: Automated testing of context preservation quality

---

## Example Workflow

```powershell
# 1. End of session - save context
.\tools\context\Save-LTFContext.ps1 -Tier Micro -Notes "Completed v3.0 implementation"

# 2. Later session - resume context
.\tools\context\Resume-LTF.ps1 -Latest

# 3. Copy/paste the 5-step transfer prompt into new AI session

# 4. AI loads each layer in priority order and validates restoration

# 5. Continue work seamlessly (it feels like "we never stopped")
```

---

**Last Updated**: 2025-11-12  
**Framework**: LTF (Living Task Framework)  
**CFP Version**: 3.0
